<div class="reset-password-page">
  <div class="brand">
    <img src="assets/images/logos/logo-light.png" alt="ReclamaFácil" class="brand-logo" />
  </div>
  <div class="reset-password-card">
    <div class="reset-password-header">
      <h1>Restablece tu contraseña</h1>
      <p>Elige una nueva contraseña segura</p>
    </div>

    <form class="reset-password-form" [formGroup]="form" (ngSubmit)="submit()" autocomplete="on">
      <div class="field">
        <label class="field-label" for="newPassword">Nueva contraseña</label>
        <div class="input-wrap">
          <input 
            id="newPassword" 
            [type]="showPassword() ? 'text' : 'password'" 
            placeholder="Mínimo 8 caracteres"
            formControlName="password"
            [attr.aria-invalid]="passwordControl.invalid && passwordControl.touched"
            autocomplete="new-password"
          />
          <button 
            class="icon-btn" 
            type="button" 
            (click)="togglePassword()"
            [attr.aria-label]="showPassword() ? 'Ocultar contraseña' : 'Mostrar contraseña'"
            [attr.aria-pressed]="showPassword()"
          >
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none">
              <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12z" stroke="#8B8B8B" stroke-width="1.6" />
              <circle cx="12" cy="12" r="3" stroke="#8B8B8B" stroke-width="1.6" />
            </svg>
          </button>
        </div>
        @if (passwordControl.invalid && passwordControl.touched) {
          <span class="field-error">
            @if (passwordControl.hasError('required')) {
              La contraseña es requerida
            }
            @if (passwordControl.hasError('minlength')) {
              Mínimo 8 caracteres
            }
            @if (passwordControl.hasError('pattern')) {
              Incluye mayúsculas, minúsculas, número y carácter especial
            }
          </span>
        }
      </div>

      <div class="field">
        <label class="field-label" for="confirmNewPassword">Confirmar contraseña</label>
        <div class="input-wrap">
          <input 
            id="confirmNewPassword" 
            [type]="showConfirmPassword() ? 'text' : 'password'" 
            placeholder="Repite tu contraseña"
            formControlName="confirmPassword"
            [attr.aria-invalid]="(confirmPasswordControl.invalid && confirmPasswordControl.touched) || (form.errors?.['passwordsMismatch'] && confirmPasswordControl.touched)"
            autocomplete="new-password"
          />
          <button 
            class="icon-btn" 
            type="button" 
            (click)="toggleConfirmPassword()"
            [attr.aria-label]="showConfirmPassword() ? 'Ocultar contraseña' : 'Mostrar contraseña'"
            [attr.aria-pressed]="showConfirmPassword()"
          >
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none">
              <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12z" stroke="#8B8B8B" stroke-width="1.6" />
              <circle cx="12" cy="12" r="3" stroke="#8B8B8B" stroke-width="1.6" />
            </svg>
          </button>
        </div>
        @if (confirmPasswordControl.invalid && confirmPasswordControl.touched) {
          <span class="field-error">
            @if (confirmPasswordControl.hasError('required')) {
              Confirma tu contraseña
            }
          </span>
        }
        @if (form.errors?.['passwordsMismatch'] && confirmPasswordControl.touched) {
          <span class="field-error">
            Las contraseñas no coinciden
          </span>
        }
      </div>

      <button 
        class="btn-primary" 
        type="submit"
        [disabled]="isSubmitting() || form.invalid"
      >
        {{ isSubmitting() ? 'Actualizando...' : 'Guardar contraseña' }}
      </button>

      <a routerLink="/auth/login" class="btn-ghost-link">Volver al login</a>
    </form>
  </div>

  <div class="footer">
    <p class="copyright">© 2026 ReclamaFácil</p>
    <app-theme-toggle></app-theme-toggle>
  </div>
  <app-toast-container />
</div>
