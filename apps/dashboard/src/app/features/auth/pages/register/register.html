<main class="register-container">
  <header class="register-header">
    <div class="register-brand">
      <svg class="register-brand-logo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        aria-hidden="true">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="12" y1="18" x2="12" y2="12"></line>
        <line x1="9" y1="15" x2="15" y2="15"></line>
      </svg>
      <span class="register-brand__text">ReclamoFácil</span>
    </div>
    <app-theme-toggle></app-theme-toggle>
  </header>

  <article class="register-card" aria-labelledby="register-title">
    <h1 id="register-title" class="register-title">Crear cuenta</h1>
    <p class="register-subtitle">Regístrate y cumple con INDECOPI</p>

    @if (successMessage()) {
      <div class="alert alert-success" role="alert">
        {{ successMessage() }}
      </div>
    }

    <form class="register-form" [formGroup]="form" (ngSubmit)="submit()" autocomplete="on">
      <div class="form-group">
        <label class="form-label" for="email">Correo electrónico</label>
        <div class="register-input">
          <span class="register-input-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 6h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Z"></path>
              <path d="m22 8-10 6L2 8"></path>
            </svg>
          </span>
          <input id="email" formControlName="email" type="email" class="form-input" placeholder="tu@empresa.com"
            autocomplete="email" />
        </div>
        @if (emailControl.invalid && emailControl.touched) {
          <span class="form-error-message">
            @if (emailControl.hasError('required')) {
              El correo electrónico es requerido
            } @else if (emailControl.hasError('email')) {
              Ingresa un correo electrónico válido
            }
          </span>
        }
      </div>

      <div class="form-group">
        <label class="form-label" for="password">Contraseña</label>
        <div class="register-input register-input--with-action">
          <span class="register-input-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"
              stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="11" width="18" height="10" rx="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
          </span>
          <input id="password" formControlName="password" [type]="showPassword() ? 'text' : 'password'" class="form-input" placeholder="••••••••"
            autocomplete="new-password" />
          <span class="register-input-action" aria-hidden="true" (click)="togglePassword()" role="button" tabindex="0" [attr.aria-label]="showPassword() ? 'Ocultar contraseña' : 'Mostrar contraseña'">
            @if (showPassword()) {
              <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path>
                <path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"></path>
                <path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"></path>
                <line x1="2" x2="22" y1="2" y2="22"></line>
              </svg>
            } @else {
              <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M2 12s4-6 10-6 10 6 10 6-4 6-10 6S2 12 2 12Z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            }
          </span>
        </div>
        @if (showPasswordRequirements()) {
          <div class="password-requirements">
            <p class="password-requirements-title">Tu contraseña requiere:</p>
          <ul class="password-requirements-list">
            <li class="password-requirement" [class.password-requirement--valid]="hasMinLength()">
              @if (hasMinLength()) {
                <svg class="password-requirement-icon password-requirement-icon--valid" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="m9 12 2 2 4-4"></path>
                </svg>
              } @else {
                <svg class="password-requirement-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                </svg>
              }
              <span>Mínimo 8 caracteres</span>
            </li>
            <li class="password-requirement" [class.password-requirement--valid]="hasUppercase()">
              @if (hasUppercase()) {
                <svg class="password-requirement-icon password-requirement-icon--valid" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="m9 12 2 2 4-4"></path>
                </svg>
              } @else {
                <svg class="password-requirement-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                </svg>
              }
              <span>1 letra mayúscula</span>
            </li>
            <li class="password-requirement" [class.password-requirement--valid]="hasLowercase()">
              @if (hasLowercase()) {
                <svg class="password-requirement-icon password-requirement-icon--valid" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="m9 12 2 2 4-4"></path>
                </svg>
              } @else {
                <svg class="password-requirement-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                </svg>
              }
              <span>1 letra minúscula</span>
            </li>
            <li class="password-requirement" [class.password-requirement--valid]="hasNumber()">
              @if (hasNumber()) {
                <svg class="password-requirement-icon password-requirement-icon--valid" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="m9 12 2 2 4-4"></path>
                </svg>
              } @else {
                <svg class="password-requirement-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                </svg>
              }
              <span>1 número</span>
            </li>
            <li class="password-requirement" [class.password-requirement--valid]="hasSpecialChar()">
              @if (hasSpecialChar()) {
                <svg class="password-requirement-icon password-requirement-icon--valid" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="m9 12 2 2 4-4"></path>
                </svg>
              } @else {
                <svg class="password-requirement-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                </svg>
              }
              <span>1 carácter especial (ej.: ! # . $ , %)</span>
            </li>
          </ul>
          </div>
        }
        @if (passwordControl.invalid && passwordControl.touched) {
          <span class="form-error-message">
            @if (passwordControl.hasError('required')) {
              La contraseña es requerida
            } @else if (passwordControl.hasError('minlength')) {
              La contraseña debe tener al menos 8 caracteres
            } @else if (passwordControl.hasError('pattern')) {
              La contraseña no cumple con los requisitos
            }
          </span>
        }
      </div>

      <div class="form-group">
        <label class="form-label" for="confirm-password">Confirmar contraseña</label>
        <div class="register-input register-input--with-action">
          <span class="register-input-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"
              stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="11" width="18" height="10" rx="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
          </span>
          <input id="confirmPassword" formControlName="confirmPassword" [type]="showConfirmPassword() ? 'text' : 'password'" class="form-input" placeholder="••••••••"
            autocomplete="new-password" />
          <span class="register-input-action" aria-hidden="true" (click)="toggleConfirmPassword()" role="button" tabindex="0" [attr.aria-label]="showConfirmPassword() ? 'Ocultar contraseña' : 'Mostrar contraseña'">
            @if (showConfirmPassword()) {
              <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path>
                <path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"></path>
                <path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"></path>
                <line x1="2" x2="22" y1="2" y2="22"></line>
              </svg>
            } @else {
              <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M2 12s4-6 10-6 10 6 10 6-4 6-10 6S2 12 2 12Z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            }
          </span>
        </div>
        @if (confirmPasswordControl.invalid && confirmPasswordControl.touched) {
          <span class="form-error-message">
            @if (confirmPasswordControl.hasError('required')) {
              Debes confirmar tu contraseña
            }
          </span>
        }
        @if (form.hasError('passwordsMismatch') && confirmPasswordControl.touched) {
          <span class="form-error-message">
            Las contraseñas no coinciden
          </span>
        }
      </div>

      <fieldset class="register-terms-group">
        <legend class="sr-only">Aceptar términos y condiciones</legend>
        <div class="register-checkbox-wrapper">
          <input id="terms" formControlName="terms" type="checkbox" class="form-checkbox" />
          <label class="register-checkbox-label" for="terms">
            <span class="register-checkbox-text">
              Acepto la <a href="/privacy" target="_blank" rel="noopener noreferrer">política de privacidad</a>
              <span class="register-separator">y</span>los <a href="/terms" target="_blank"
                rel="noopener noreferrer">términos de servicio</a>
            </span>
          </label>
        </div>
        @if (termsControl.invalid && termsControl.touched) {
          <span class="form-error-message">
            Debes aceptar los términos y condiciones
          </span>
        }
      </fieldset>

      <button type="submit" class="btn btn-primary register-primary-btn" [disabled]="isSubmitting()">
        @if (isSubmitting()) {
          <span class="register-btn-loading">
            <svg class="spinner" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10" stroke-opacity="0.25"></circle>
              <path d="M12 2a10 10 0 0 1 10 10" stroke-linecap="round"></path>
            </svg>
          </span>
          <span>Creando cuenta...</span>
        } @else {
          <span>Crear cuenta</span>
          <span class="register-btn-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M5 12h14"></path>
              <path d="m13 6 6 6-6 6"></path>
            </svg>
          </span>
        }
      </button>
    </form>

    <hr class="register-divider" />

    <button type="button" class="btn btn-outline register-google-btn">
      <span class="register-google-icon" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 0 24 24" width="18">
          <path
            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
            fill="#4285F4" />
          <path
            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
            fill="#34A853" />
          <path
            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
            fill="#FBBC05" />
          <path
            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
            fill="#EA4335" />
          <path d="M1 1h22v22H1z" fill="none" />
        </svg>
      </span>
      Registrarse con Google
    </button>

    <p class="register-signin">
      ¿Ya tienes cuenta? <a class="register-link" href="/auth/login">Inicia sesión</a>
    </p>
  </article>

  <footer class="register-footer">© 2026 ReclamoFácil</footer>
</main>